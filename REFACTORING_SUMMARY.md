# ğŸ”§ é¡¹ç›®é‡æ„æ€»ç»“

## ğŸ“Š é‡æ„å‰åå¯¹æ¯”

### é‡æ„å‰ï¼ˆå•ä½“ç»“æ„ï¼‰
```
httpsserver/
â”œâ”€â”€ main.go              # æ‰€æœ‰ä¸šåŠ¡é€»è¾‘ï¼ˆ358è¡Œï¼‰
â”œâ”€â”€ config.go            # é…ç½®ç®¡ç†
â”œâ”€â”€ database.sql         # æ•°æ®åº“è„šæœ¬
â”œâ”€â”€ config.env.example   # é…ç½®ç¤ºä¾‹
â”œâ”€â”€ go.mod               # Goæ¨¡å—
â”œâ”€â”€ go.sum               # ä¾èµ–é”å®š
â”œâ”€â”€ README.md            # é¡¹ç›®è¯´æ˜
â””â”€â”€ deploy/              # éƒ¨ç½²æ–‡ä»¶
    â”œâ”€â”€ start-linux.sh
    â”œâ”€â”€ stop-linux.sh
    â””â”€â”€ ...
```

### é‡æ„åï¼ˆæ ‡å‡†Goé¡¹ç›®ç»“æ„ï¼‰
```
httpsserver/
â”œâ”€â”€ cmd/
â”‚   â””â”€â”€ server/
â”‚       â””â”€â”€ main.go           # åº”ç”¨ç¨‹åºå…¥å£ç‚¹ï¼ˆ66è¡Œï¼‰
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â””â”€â”€ auth.go           # è®¤è¯é€»è¾‘
â”‚   â”œâ”€â”€ config/
â”‚   â”‚   â””â”€â”€ config.go         # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ database/
â”‚   â”‚   â””â”€â”€ database.go       # æ•°æ®åº“æ“ä½œ
â”‚   â”œâ”€â”€ handler/
â”‚   â”‚   â””â”€â”€ handler.go        # HTTPå¤„ç†å™¨
â”‚   â”œâ”€â”€ model/
â”‚   â”‚   â””â”€â”€ request.go        # æ•°æ®æ¨¡å‹
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ cert.go           # å·¥å…·å‡½æ•°
â”œâ”€â”€ pkg/
â”‚   â””â”€â”€ response/
â”‚       â””â”€â”€ response.go       # å“åº”ç»“æ„
â”œâ”€â”€ configs/
â”‚   â””â”€â”€ config.env.example   # é…ç½®æ–‡ä»¶æ¨¡æ¿
â”œâ”€â”€ sql/
â”‚   â””â”€â”€ database.sql         # æ•°æ®åº“è„šæœ¬
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ start-linux.sh       # å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ stop-linux.sh        # åœæ­¢è„šæœ¬
â”‚   â””â”€â”€ ...
â”œâ”€â”€ docs/
â”‚   â””â”€â”€ TROUBLESHOOTING.md   # æ•…éšœæ’é™¤æŒ‡å—
â”œâ”€â”€ deployments/
â”‚   â””â”€â”€ systemd/
â”‚       â””â”€â”€ httpsserver.service # systemdæœåŠ¡æ–‡ä»¶
â”œâ”€â”€ build/                   # æ„å»ºè¾“å‡ºç›®å½•
â”œâ”€â”€ Makefile                 # æ„å»ºè„šæœ¬
â”œâ”€â”€ .gitignore               # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ LICENSE                  # å¼€æºè®¸å¯è¯
â”œâ”€â”€ README.md                # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ go.mod                   # Goæ¨¡å—
â””â”€â”€ go.sum                   # ä¾èµ–é”å®š
```

## ğŸ—ï¸ æ¶æ„æ”¹è¿›

### 1. å…³æ³¨ç‚¹åˆ†ç¦»ï¼ˆSeparation of Concernsï¼‰

| åŒ… | èŒè´£ | æ–‡ä»¶ |
|---|---|---|
| `cmd/server` | åº”ç”¨ç¨‹åºå…¥å£ç‚¹ | main.go |
| `internal/config` | é…ç½®ç®¡ç† | config.go |
| `internal/database` | æ•°æ®åº“æ“ä½œ | database.go |
| `internal/handler` | HTTPè¯·æ±‚å¤„ç† | handler.go |
| `internal/auth` | è®¤è¯é€»è¾‘ | auth.go |
| `internal/model` | æ•°æ®æ¨¡å‹å®šä¹‰ | request.go |
| `internal/utils` | å·¥å…·å‡½æ•° | cert.go |
| `pkg/response` | å…¬å…±å“åº”ç»“æ„ | response.go |

### 2. ä»£ç ç»„ç»‡æ”¹è¿›

#### é‡æ„å‰é—®é¢˜ï¼š
- âŒ æ‰€æœ‰ä»£ç é›†ä¸­åœ¨ä¸€ä¸ªæ–‡ä»¶ï¼ˆmain.go 358è¡Œï¼‰
- âŒ ä¸šåŠ¡é€»è¾‘ã€æ•°æ®åº“æ“ä½œã€HTTPå¤„ç†æ··åˆ
- âŒ éš¾ä»¥æµ‹è¯•å’Œç»´æŠ¤
- âŒ ä¸ç¬¦åˆGoè¯­è¨€æœ€ä½³å®è·µ

#### é‡æ„åä¼˜åŠ¿ï¼š
- âœ… ä»£ç æŒ‰åŠŸèƒ½æ¨¡å—åŒ–ç»„ç»‡
- âœ… æ¸…æ™°çš„åŒ…è¾¹ç•Œå’ŒèŒè´£åˆ†å·¥
- âœ… æ˜“äºå•å…ƒæµ‹è¯•
- âœ… ç¬¦åˆGoè¯­è¨€æ ‡å‡†é¡¹ç›®å¸ƒå±€
- âœ… ä¾¿äºå›¢é˜Ÿåä½œå¼€å‘

### 3. é¡¹ç›®æ ‡å‡†åŒ–

#### æ–°å¢æ ‡å‡†æ–‡ä»¶ï¼š
- âœ… **Makefile** - æ ‡å‡†åŒ–æ„å»ºå’Œéƒ¨ç½²
- âœ… **.gitignore** - Gitç‰ˆæœ¬æ§åˆ¶ä¼˜åŒ–
- âœ… **LICENSE** - å¼€æºè®¸å¯è¯
- âœ… **docs/TROUBLESHOOTING.md** - æ•…éšœæ’é™¤æŒ‡å—
- âœ… **æ ‡å‡†ç›®å½•ç»“æ„** - ç¬¦åˆGoç¤¾åŒºçº¦å®š

#### æ„å»ºç³»ç»Ÿï¼š
```bash
# æ„å»ºå‘½ä»¤
make build           # æœ¬åœ°æ„å»º
make build-linux     # Linuxç‰ˆæœ¬
make build-windows   # Windowsç‰ˆæœ¬
make build-darwin    # macOSç‰ˆæœ¬
make build-all       # æ‰€æœ‰å¹³å°

# å¼€å‘å‘½ä»¤
make run             # è¿è¡Œåº”ç”¨
make test            # è¿è¡Œæµ‹è¯•
make fmt             # ä»£ç æ ¼å¼åŒ–
make clean           # æ¸…ç†æ„å»ºæ–‡ä»¶

# éƒ¨ç½²å‘½ä»¤
make cert            # ç”ŸæˆSSLè¯ä¹¦
make package         # åˆ›å»ºéƒ¨ç½²åŒ…
```

## ğŸ“ˆ æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§æ”¹è¿›

### 1. æ¨¡å—åŒ–è®¾è®¡
- **æ•°æ®åº“å±‚**ï¼šç‹¬ç«‹çš„æ•°æ®åº“æ“ä½œé€»è¾‘
- **ä¸šåŠ¡å±‚**ï¼šæ¸…æ™°çš„ä¸šåŠ¡é€»è¾‘åˆ†ç¦»
- **è¡¨ç¤ºå±‚**ï¼šä¸“é—¨çš„HTTPå¤„ç†å’Œå“åº”æ ¼å¼åŒ–

### 2. é”™è¯¯å¤„ç†
- ä½¿ç”¨Goæ ‡å‡†é”™è¯¯å¤„ç†æ¨¡å¼
- ç»“æ„åŒ–é”™è¯¯ä¿¡æ¯
- è¯¦ç»†çš„æ—¥å¿—è®°å½•

### 3. é…ç½®ç®¡ç†
- ç¯å¢ƒå˜é‡æ”¯æŒ
- é…ç½®æ–‡ä»¶æ¨¡æ¿
- é»˜è®¤å€¼å¤„ç†

## ğŸ§ª æµ‹è¯•èƒ½åŠ›æå‡

### é‡æ„å‰ï¼š
```go
// éš¾ä»¥æµ‹è¯• - æ‰€æœ‰é€»è¾‘è€¦åˆåœ¨ä¸€èµ·
func main() {
    // æ•°æ®åº“è¿æ¥
    // HTTPè·¯ç”±
    // ä¸šåŠ¡é€»è¾‘
    // è®¤è¯é€»è¾‘
    // å…¨éƒ¨æ··åˆåœ¨ä¸€èµ·
}
```

### é‡æ„åï¼š
```go
// æ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥ç‹¬ç«‹æµ‹è¯•
func TestAuthentication(t *testing.T) {
    authSvc := auth.New(config)
    result := authSvc.Authenticate(request)
    assert.True(t, result)
}

func TestDatabaseQuery(t *testing.T) {
    db := database.New(config)
    results, total, err := db.QueryMetadata(request)
    assert.NoError(t, err)
}
```

## ğŸš€ éƒ¨ç½²ä¼˜åŒ–

### å¤šå¹³å°æ”¯æŒ
```bash
# ä¸€é”®æ„å»ºæ‰€æœ‰å¹³å°
make build-all

# ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶
build/
â”œâ”€â”€ httpsserver           # å½“å‰å¹³å°
â”œâ”€â”€ httpsserver-linux     # Linux
â”œâ”€â”€ httpsserver-windows   # Windows  
â””â”€â”€ httpsserver-darwin    # macOS
```

### å®¹å™¨åŒ–æ”¯æŒ
é‡æ„åçš„ç»“æ„æ›´é€‚åˆå®¹å™¨åŒ–éƒ¨ç½²ï¼š
```dockerfile
FROM golang:1.21-alpine AS builder
WORKDIR /app
COPY . .
RUN make build-linux

FROM alpine:latest
COPY --from=builder /app/build/httpsserver-linux /usr/local/bin/httpsserver
CMD ["httpsserver"]
```

## ğŸ“‹ è¿ç§»æŒ‡å—

### å¦‚ä½•ä½¿ç”¨æ–°ç»“æ„

1. **å¼€å‘ç¯å¢ƒ**
   ```bash
   # ä½¿ç”¨æ–°çš„æ„å»ºç³»ç»Ÿ
   make deps    # å®‰è£…ä¾èµ–
   make build   # æ„å»ºåº”ç”¨
   make run     # è¿è¡Œå¼€å‘æœåŠ¡å™¨
   ```

2. **ç”Ÿäº§éƒ¨ç½²**
   ```bash
   # æ„å»ºç”Ÿäº§ç‰ˆæœ¬
   make build-linux
   
   # åˆ›å»ºéƒ¨ç½²åŒ…
   make package
   
   # ä¸Šä¼ åˆ°æœåŠ¡å™¨
   scp deployments/*.tar.gz server:/tmp/
   ```

3. **é…ç½®ç®¡ç†**
   ```bash
   # å¤åˆ¶é…ç½®æ¨¡æ¿
   cp configs/config.env.example config.env
   
   # ç¼–è¾‘é…ç½®
   nano config.env
   ```

## ğŸ¯ æ€»ç»“

è¿™æ¬¡é‡æ„å°†é¡¹ç›®ä»å•ä½“ç»“æ„è½¬æ¢ä¸ºæ ‡å‡†çš„Goé¡¹ç›®å¸ƒå±€ï¼Œä¸»è¦æ”¹è¿›åŒ…æ‹¬ï¼š

1. **âœ… ä»£ç ç»„ç»‡** - ä»358è¡Œå•æ–‡ä»¶æ‹†åˆ†ä¸ºå¤šä¸ªä¸“èŒæ¨¡å—
2. **âœ… å¯ç»´æŠ¤æ€§** - æ¸…æ™°çš„åŒ…è¾¹ç•Œå’ŒèŒè´£åˆ†ç¦»
3. **âœ… å¯æµ‹è¯•æ€§** - æ¯ä¸ªç»„ä»¶éƒ½å¯ä»¥ç‹¬ç«‹æµ‹è¯•
4. **âœ… æ ‡å‡†åŒ–** - ç¬¦åˆGoç¤¾åŒºæœ€ä½³å®è·µ
5. **âœ… æ„å»ºç³»ç»Ÿ** - ç°ä»£åŒ–çš„Makefileæ„å»ºæµç¨‹
6. **âœ… æ–‡æ¡£å®Œå–„** - å®Œæ•´çš„READMEå’Œæ•…éšœæ’é™¤æŒ‡å—
7. **âœ… éƒ¨ç½²ä¼˜åŒ–** - å¤šå¹³å°æ”¯æŒå’Œæ ‡å‡†åŒ–éƒ¨ç½²æµç¨‹

æ–°çš„é¡¹ç›®ç»“æ„ä¸ºåç»­åŠŸèƒ½æ‰©å±•ã€å›¢é˜Ÿåä½œå’Œç»´æŠ¤æä¾›äº†æ›´å¥½çš„åŸºç¡€ã€‚ 